const scriptUrl = document.querySelector('script[src*="arivubot.min.js"]').src;
const url = new URL(scriptUrl);
const apiKey = url.searchParams.get('apiKey');

if (apiKey !== '') {
    import('https://openfpcdn.io/fingerprintjs/v4')
        .then(FingerprintJS => {
            return FingerprintJS.load();
        })
        .then(fp => {
            return fp.get();
        })
        .then(result => {
            const userID = result.visitorId;
            const rootDiv = document.createElement('div');
            rootDiv.id = 'arivubot';
            document.body.appendChild(rootDiv);

            window.apiKey = apiKey;
            window.userId = userID;

            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = './chatbot.css';
            document.head.appendChild(link);

            const script = document.createElement('script');
            script.src = './chatbot.js';
            script.defer = true;
            document.body.appendChild(script);

        })
}